{
"ТекстЗапроса": "ВЫБРАТЬ\n\u0009ВзаиморасчетыССотрудникамиОстатки.ФизическоеЛицо КАК ФизическоеЛицо,\n\u0009ВзаиморасчетыССотрудникамиОстатки.Сотрудник КАК Сотрудник,\n\u0009КОЛИЧЕСТВО(ВзаиморасчетыССотрудникамиОстатки.ФизическоеЛицо) КАК ВсегоФизЛиц,\n\u0009ВзаиморасчетыССотрудникамиОстатки.СуммаВзаиморасчетовОстаток КАК Остаток,\n\u0009ВзаиморасчетыССотрудникамиОстатки.СтатьяФинансирования КАК СтатьяФинансирования,\n\u0009ВзаиморасчетыССотрудникамиОстатки.СтатьяРасходов КАК СтатьяРасходов,\n\u0009ВзаиморасчетыССотрудникамиОстатки.Подразделение КАК Подразделение\nПОМЕСТИТЬ ОстаткиЗадолженности\nИЗ\n\u0009РегистрНакопления.ВзаиморасчетыССотрудниками.Остатки(&НаДату, ) КАК ВзаиморасчетыССотрудникамиОстатки\n\nСГРУППИРОВАТЬ ПО\n\u0009ВзаиморасчетыССотрудникамиОстатки.СуммаВзаиморасчетовОстаток,\n\u0009ВзаиморасчетыССотрудникамиОстатки.ФизическоеЛицо,\n\u0009ВзаиморасчетыССотрудникамиОстатки.Сотрудник,\n\u0009ВзаиморасчетыССотрудникамиОстатки.СтатьяФинансирования,\n\u0009ВзаиморасчетыССотрудникамиОстатки.СтатьяРасходов,\n\u0009ВзаиморасчетыССотрудникамиОстатки.Подразделение\n\nИНДЕКСИРОВАТЬ ПО\n\u0009ФизическоеЛицо,\n\u0009ВсегоФизЛиц\n;\n\n////////////////////////////////////////////////////////////////////////////////\nВЫБРАТЬ\n\u0009ОстаткиЗадолженности.ФизическоеЛицо КАК ФизическоеЛицо\nПОМЕСТИТЬ НеверныеПереносы\nИЗ\n\u0009ОстаткиЗадолженности КАК ОстаткиЗадолженности\n\nСГРУППИРОВАТЬ ПО\n\u0009ОстаткиЗадолженности.ФизическоеЛицо\n\nИМЕЮЩИЕ\n\u0009СУММА(ОстаткиЗадолженности.Остаток) = 0 И\n\u0009СУММА(ОстаткиЗадолженности.ВсегоФизЛиц) > 1\n\nИНДЕКСИРОВАТЬ ПО\n\u0009ФизическоеЛицо\n;\n\n////////////////////////////////////////////////////////////////////////////////\nВЫБРАТЬ\n\u0009НеверныеПереносы.ФизическоеЛицо КАК ФизическоеЛицо,\n\u0009ОстаткиЗадолженности.Сотрудник КАК Сотрудник,\n\u0009ТекущиеКадровыеДанныеСотрудников.ДатаПриема КАК ДатаПриема,\n\u0009ТекущиеКадровыеДанныеСотрудников.ДатаУвольнения КАК ДатаУвольнения,\n\u0009ОстаткиЗадолженности.Остаток КАК Остаток,\n\u0009ОстаткиЗадолженности.СтатьяФинансирования КАК СтатьяФинансирования,\n\u0009ОстаткиЗадолженности.СтатьяРасходов КАК СтатьяРасходов,\n\u0009ОстаткиЗадолженности.Подразделение КАК Подразделение\nИЗ\n\u0009ОстаткиЗадолженности КАК ОстаткиЗадолженности\n\u0009\u0009ВНУТРЕННЕЕ СОЕДИНЕНИЕ НеверныеПереносы КАК НеверныеПереносы\n\u0009\u0009ПО ОстаткиЗадолженности.ФизическоеЛицо = НеверныеПереносы.ФизическоеЛицо\n\u0009\u0009ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТекущиеКадровыеДанныеСотрудников КАК ТекущиеКадровыеДанныеСотрудников\n\u0009\u0009ПО ОстаткиЗадолженности.ФизическоеЛицо = ТекущиеКадровыеДанныеСотрудников.ФизическоеЛицо\n\u0009\u0009\u0009И ОстаткиЗадолженности.Сотрудник = ТекущиеКадровыеДанныеСотрудников.Сотрудник\n\nУПОРЯДОЧИТЬ ПО\n\u0009ФизическоеЛицо\nАВТОУПОРЯДОЧИВАНИЕ",
"Обработчик": "//Наименования переменных:\n  //Объект.СправочникПервый\n  //Объект.СправочникВторой\n  //Объект.Документ\n  //Объект.ДатаНачала\n  //Объект.ДатаОкончания\n  //Объект.БизнесПроцесс\n  //Объект.Задача\n  //ДополнительныеСвойства.Вставить(\"ОтключитьПроверкуДатыЗапретаИзменения\",Истина);\n  //--------\n\n  Запрос=Новый Запрос;\n  Запрос.Текст=тТекстЗапроса;\n  Запрос.УстановитьПараметр(\"НаДату\",Новый Граница(Дата(2019,12,31,23,59,59),ВидГраницы.Включая));\nРезультатЗапроса=Запрос.Выполнить();\nЕсли РезультатЗапроса.Пустой() Тогда\n\u0009ВызватьИсключение \"Пустой результат запроса\";\nКонецЕсли;\nДокумент=Документы.ПереносДанных.СоздатьДокумент();\nДокумент.Дата=ТекущаяДата();\nДокумент.Ответственный=Объект.СправочникПервый;\nДокумент.ПериодРегистрации=Дата(2018,12,31,23,59,59);\nДокумент.Организация=Справочники.Организации.ОрганизацияПоУмолчанию();\nДокумент.Комментарий=\"Корректировка РН Взаиморасчеты с сотрудниками\";\nНоваяСтрокаТЧ=Документ.ТаблицаРегистров.Добавить();\nИмяРегистра=\"ВзаиморасчетыССотрудниками\";\nНоваяСтрокаТЧ.Имя=ИмяРегистра;\nНоваяСсылка=Документы.ПереносДанных.ПолучитьСсылку(Новый УникальныйИдентификатор());\nДокумент.УстановитьСсылкуНового(НоваяСсылка);\n\nВыборка=РезультатЗапроса.Выбрать();\nНаборЗаписей=РегистрыНакопления[ИмяРегистра].СоздатьНаборЗаписей();\nНаборЗаписей.Отбор.Регистратор.Установить(НоваяСсылка);\nПока Выборка.Следующий() Цикл\n\u0009НоваяЗапись=НаборЗаписей.Добавить();\n\u0009ЗаполнитьЗначенияСвойств(НоваяЗапись,Выборка);\n\u0009НоваяЗапись.Период=?(Выборка.ДатаУвольнения=Дата(1,1,1),Документ.ПериодРегистрации,Выборка.ДатаУвольнения);\n\u0009НоваяЗапись.Регистратор=НоваяСсылка;\n\u0009НоваяЗапись.Организация=Документ.Организация;\n\u0009НоваяЗапись.ВидДвижения=?(Выборка.Остаток<0,ВидДвиженияНакопления.Приход,ВидДвиженияНакопления.Расход);\n\u0009НоваяЗапись.СуммаВзаиморасчетов=Макс(Выборка.Остаток,-Выборка.Остаток);\u0009\u0009\u0009\nКонецЦикла;\nПопытка\n\u0009Документ.Записать();\n\u0009НаборЗаписей.Записать();\nИсключение\n\u0009Сообщить(ОписаниеОшибки());\nКонецПопытки;",
"СтрокаПроверяемыхРеквизитов": "СправочникПервый",
"Параметры": [
{
"Параметр": "СправочникПервый",
"Тип": "CatalogRef.Пользователи",
"Значение": "ca329ece-2087-11e5-80c7-00155d05dc00"
}
]
}